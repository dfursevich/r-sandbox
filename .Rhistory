globalTrendDelta <- 0
globalTrendDeltaMax <- 0
output = lapply(1:nrow(data), function(i) {
delta <- 0
trendTurnPercent <- 0
currentRow <- data[i,]
if (i > 1) {
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (trendDelta * delta >= 0) {
trendDelta <<- trendDelta + delta
trendTurnPercent <- 0
} else {
#turn
trendTurnPercent <- abs(100 * delta/trendDelta)
trendDelta <<- delta
}
if (globalTrendDeltaMax * delta >= 0) {
globalTrendDelta <<- globalTrendDelta + delta
} else {
globalTrendDelta <<- globalTrendDelta + delta
if ((globalTrendDeltaMax - globalTrendDelta) / globalTrendDeltaMax > 0.2) {
globalTrendDelta <<- delta
globalTrendDeltaMax <<- globalTrendDelta
}
}
if (abs(globalTrendDelta) > abs(globalTrendDeltaMax)) {
globalTrendDeltaMax <<- globalTrendDelta
}
}
currentRow["X.DELTA."] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["X.TREND."] <- format(trendDelta, scientific=FALSE, nsmall=4)
currentRow["X.TURN_PERCENT."] <- format(round(trendTurnPercent, 2), scientific=FALSE, nsmall=2)
currentRow["X.G_TREND."] <- format(globalTrendDelta, scientific=FALSE, nsmall=4)
currentRow["X.G_TREND_M."] <- format(globalTrendDeltaMax, scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 100)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.2) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 100)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.3) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 100)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.3) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND"] >= 0.0129, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 100)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.3) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[abs(output["MAX_TREND"]) >= 0.02, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 100)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.3) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND"] >= 0.02, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 100)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.3) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND_ABS"] <- format(abs(trendMax), scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND_ABS"] >= 0.02, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 1000)
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 1000)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.3) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND_ABS"] <- format(abs(trendMax), scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND_ABS"] >= 0.02, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 1000)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.2) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND_ABS"] <- format(abs(trendMax), scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND_ABS"] >= 0.02, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"), 10000)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.2) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND_ABS"] <- format(abs(trendMax), scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND_ABS"] >= 0.02, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"))
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.2) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND_ABS"] <- format(abs(trendMax), scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND_ABS"] >= 0.02, ]
output
data <- read.csv("EURUSD_hour.csv", colClasses ="character")
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.2) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND_ABS"] <- format(abs(trendMax), scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
output <- output[output["MAX_TREND_ABS"] >= 0.02, ]
output
data <- head(read.csv("EURUSD_hour.csv", colClasses ="character"),10)
firstRow = data[1, ]
firstRow["DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["LONG_DELTA"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["TREND"] <- format(0, scientific=FALSE, nsmall=4)
firstRow["MAX_TREND"] <- format(0, scientific=FALSE, nsmall=4)
longDelta <- 0
trend <- 0
trendMax <- 0
output = lapply(2:nrow(data), function(i) {
currentRow <- data[i,]
prevRow <- data[i-1,]
delta <- as.numeric(currentRow["X.OPEN."]) - as.numeric(prevRow["X.OPEN."])
if (longDelta * delta >= 0) {
longDelta <<- longDelta + delta
} else {
longDelta <<- delta
}
if (trend * delta >= 0) {
trend <<- trend + delta
} else {
trend <<- trend + delta
if ((trendMax - trend) / trendMax > 0.2) {
trend <<- delta
trendMax <<- trend
}
}
if (abs(trend) > abs(trendMax)) {
trendMax <<- trend
}
currentRow["DELTA"] <- format(delta, scientific=FALSE, nsmall=4)
currentRow["LONG_DELTA"] <- format(longDelta, scientific=FALSE, nsmall=4)
currentRow["TREND"] <- format(trend, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND"] <- format(trendMax, scientific=FALSE, nsmall=4)
currentRow["MAX_TREND_ABS"] <- format(abs(trendMax), scientific=FALSE, nsmall=4)
currentRow
})
output = do.call(rbind, output)
write.csv(output, file = "EURUSD_hour_output.csv")
